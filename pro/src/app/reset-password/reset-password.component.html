<canvas #canvas class="particles-canvas"></canvas>
<div class="login-container" [@fadeInOut]>
  <div class="login-card" [@slideInOut]>
    <div class="login-left">
      <div class="login-content">
        <h1 class="welcome-text">University Restaurant</h1>
        <p class="slogan">Secure your account</p>
        <div class="food-animation">
          <svg class="food-icon food-icon-1" viewBox="0 0 24 24">
            <path d="M18.06 23H19.72C20.56 23 21.25 22.35 21.35 21.53L23 5.05H18V1H16.03V5.05H11.06L11.36 7.39C13.07 7.86 14.67 8.71 15.94 9.88C17.45 11.29 18.5 13.14 18.88 15.23L18.06 23M1 22V21H16.03V22C16.03 22.54 15.58 23 15 23H2C1.45 23 1 22.54 1 22M16.03 15C16.03 7 1 7 1 15H16.03Z" />
          </svg>
          <svg class="food-icon food-icon-2" viewBox="0 0 24 24">
            <path d="M15.5,21L14,8H16.23L15.1,3.46L16.84,3L18.09,8H22L20.5,21H15.5M5,11H10A3,3 0 0,1 13,14H2A3,3 0 0,1 5,11M13,18V21H2V18H13M3,15H12V17H3V15Z" />
          </svg>
          <svg class="food-icon food-icon-3" viewBox="0 0 24 24">
            <path d="M12,3C8,3 4,5 4,9C4,11.5 5.25,13.2 7,14.6V22H9V16H11V22H13V16H15V22H17V14.6C18.8,13.2 20,11.5 20,9C20,5 16,3 12,3M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5Z" />
          </svg>
        </div>
      </div>
    </div>
    <div class="login-right" [ngClass]="{'shake': formSubmitAttempted && resetPasswordForm.invalid}">
      <div class="login-form-container" [ngClass]="{'success-highlight': resetSuccess}">
        <div class="logo-container">
          <div class="university-logo">
            <span>U</span>
            <div class="logo-pulse"></div>
          </div>
        </div>
        <h2 class="form-title">Reset Password</h2>
        <p class="form-subtitle">Create a new secure password</p>
        
        <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
          <div class="form-group" [ngClass]="{'has-error': isSubmitted && formControls['newPassword'].errors}">
            <label for="newPassword">New Password</label>
            <div class="input-container">
              <i class="bi bi-lock-fill"></i>
              <input 
                type="password" 
                id="newPassword" 
                formControlName="newPassword" 
                placeholder="Enter new password"
                [ngClass]="{'invalid-input': isSubmitted && formControls['newPassword'].errors}"
              >
              <span class="input-focus-border"></span>
            </div>
            <div class="error-message" *ngIf="isSubmitted && formControls['newPassword'].errors">
              <span *ngIf="formControls['newPassword'].errors['required']">Password is required</span>
              <span *ngIf="formControls['newPassword'].errors['minlength']">Password must be at least 8 characters</span>
            </div>
          </div>

          <div class="form-group" [ngClass]="{'has-error': isSubmitted && formControls['confirmPassword'].errors}">
            <label for="confirmPassword">Confirm Password</label>
            <div class="input-container">
              <i class="bi bi-lock-fill"></i>
              <input 
                type="password" 
                id="confirmPassword" 
                formControlName="confirmPassword" 
                placeholder="Confirm new password"
                [ngClass]="{'invalid-input': isSubmitted && formControls['confirmPassword'].errors}"
              >
              <span class="input-focus-border"></span>
            </div>
            <div class="error-message" *ngIf="isSubmitted && formControls['confirmPassword'].errors">
              <span *ngIf="formControls['confirmPassword'].errors['required']">Please confirm your password</span>
            </div>
            <div class="error-message" *ngIf="isSubmitted && resetPasswordForm.errors?.['passwordMismatch']">
              Passwords do not match
            </div>
          </div>

          <button 
            type="submit" 
            class="login-button" 
            [disabled]="loading"
          >
            <span *ngIf="!loading">Reset Password</span>
            <div *ngIf="loading" class="spinner">
              <span class="spinner-circle"></span>
            </div>
          </button>
        </form>
        
        <p class="signup-text">
          Remember your password? <a routerLink="/login">Back to login</a>
        </p>
      </div>
    </div>
  </div>
</div>

<div class="alert-container" *ngIf="successMessage">
  <div class="alert alert-success" [@fadeInOut]>
    <i class="bi bi-check-circle-fill"></i>
    {{ successMessage }}
    <button class="close-btn" (click)="clearSuccess()">×</button>
  </div>
</div>

<div class="alert-container" *ngIf="errorMessage">
  <div class="alert alert-danger" [@fadeInOut]>
    <i class="bi bi-exclamation-circle-fill"></i>
    {{ errorMessage }}
    <button class="close-btn" (click)="clearError()">×</button>
  </div>
</div>